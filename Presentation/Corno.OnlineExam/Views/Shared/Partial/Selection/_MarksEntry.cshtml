@model Corno.Data.Corno.MarksEntry
@using Corno.Globals.Constants
@using Kendo.Mvc.UI

@{
    var collegeId = Model.CollegeId ?? 0;
    var isMarksEntryStaff = User.IsInRole(RoleConstants.MarksEntryStaff);
}

<div class="form-group">
    @*@Html.HiddenFor(model => model.CollegeId)*@
    <label class="col-sm-2 control-label">College <code>*</code>:</label>
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CollegeId)
            .Enable(!isMarksEntryStaff)
            .HtmlAttributes(new { style = "width:100%" })
            .Placeholder("Select College...")
            .Filter(FilterType.Contains)
            .DataTextField(ModelConstants.NameWithId)
            .DataValueField(ModelConstants.Id)
            .Value(collegeId > 0 ? collegeId.ToString() : string.Empty)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("GetColleges", "University");
                });
            }))
    </div>
</div>
<div class="form-group">
    <label class="col-sm-2 control-label">Center <code>*</code>:</label>
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CentreId)
            .Enable(false)
            .HtmlAttributes(new {style = "width:100%"})
            .Placeholder("Select Course Type...")
            .DataTextField(ModelConstants.NameWithId)
            .DataValueField(ModelConstants.Id)
            .Filter(FilterType.Contains)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("GetCentersByCollege", "University")
                        .Data("filterCentres");
                })
                    .ServerFiltering(true);
            })
            .AutoBind(false)
            .CascadeFrom("CollegeId")
            )
        @Html.ValidationMessageFor(m => m.CentreId)
        <script>
            function filterCentres() {
            return {
                collegeId: $("#CollegeId").val()
            };
        }
    </script>
    </div>
</div>
<div class="form-group">
    <label class="col-sm-2 control-label">Course Type <code>*</code>:</label>
    <div class="col-sm-10">
        @*@Html.HiddenFor(model => model.CourseTypeId)*@
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CourseTypeId)
              .Enable(false)
              .HtmlAttributes(new {style = "width:100%"})
              .Placeholder("Select Course Type...")
              .DataTextField(ModelConstants.NameWithId)
              .DataValueField(ModelConstants.Id)
              .Filter(FilterType.Contains)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
              .DataSource(source =>
              {
                  source.Read(read =>
                  {
                      read.Action("GetCourseTypesByCollege", "University")
                          .Data("filterCourseTypes");
                  })
                      .ServerFiltering(true);
              })
              .AutoBind(false)
              .CascadeFrom("CollegeId")
              )
        @Html.ValidationMessageFor(m => m.CourseTypeId)
        <script>
            function filterCourseTypes() {
                return {
                    collegeId: $("#CollegeId").val()
                };
            }
        </script>
    </div>
</div>
<div class="form-group">
    <label class="col-sm-2 control-label">Course <code>*</code>:</label>
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CourseId)
              .HtmlAttributes(new {style = "width:100%", @diabled = "disabled"})
              .Placeholder("Select Course...")
              .DataTextField(ModelConstants.NameWithId)
              .DataValueField(ModelConstants.Id)
              .Filter(FilterType.Contains)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
              .DataSource(source =>
              {
                  source.Read(read =>
                  {
                      read.Action("GetAllCoursesByCollegeAndCourseType", "University")
                          .Data("filterCourses");
                  })
                      .ServerFiltering(true);
              })
              .Enable(false)
              .AutoBind(false)
              .CascadeFrom("CourseTypeId")
              )
        <script>
            function filterCourses() {
                return {
                    CollegeId: $("#CollegeId").val(),
                    CourseTypeId: $("#CourseTypeId").val()
                };
            }
        </script>
    </div>
</div>
<div class="form-group">
    <label class="col-sm-2 control-label">Course Part <code>*</code>:</label>
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CoursePartId)
              .HtmlAttributes(new {style = "width:100%"})
            .Placeholder("Select Course Part...")
              .DataTextField(ModelConstants.NameWithId)
              .DataValueField(ModelConstants.Id)
              .Filter(FilterType.Contains)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
              .DataSource(source =>
              {
                  source.Read(read =>
                  {
                      read.Action("GetCoursePartsByCourse", "University")
                          .Data("filterCourseParts");
                  })
                      .ServerFiltering(true);
              })
              .Enable(false)
              .AutoBind(false)
              .CascadeFrom("CourseId")
              )
        <script>
            function filterCourseParts() {
                return {
                    courseId: $("#CourseId").val()
                };
            }
        </script>
    </div>
</div>
<div class="form-group">
    <label class="col-sm-2 control-label">Subject :</label>
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.SubjectId)
            .HtmlAttributes(new {style = "width:100%"})
            .Placeholder("Select Subject...")
            .DataTextField(ModelConstants.NameWithId)
            .DataValueField(ModelConstants.Id)
            .Filter(FilterType.Contains)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("GetSubjectsByCoursePart", "University")
                        .Data("filterSubjects");
                })
                    .ServerFiltering(true);
            })
            .Enable(false)
            .AutoBind(false)
            .CascadeFrom("CoursePartId")
            )
        <script>
            function filterSubjects() {
                return {
                    coursePartId: $("#CoursePartId").val(),
                    //branchId: $("#BranchId").val(),
                };
            }
        </script>
    </div>
</div>
<div class="form-group">
    <label class="col-sm-2 control-label">Category :</label>
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CategoryId)
            .Name(ModelConstants.CategoryId)
            .HtmlAttributes(new {style = "width:100%"})
            .Placeholder("Select Category...")
            .DataTextField(ModelConstants.NameWithId)
            .DataValueField(ModelConstants.Id)
            .Filter(FilterType.Contains)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("GetCategories", "University")
                        .Data("filterCategories");
                })
                    .ServerFiltering(true);
            })
            .Enable(false)
            .AutoBind(false)
            .CascadeFrom("SubjectId")
            )
        <script>
            function filterCategories() {
                return {
                    coursePartId: $("#CoursePartId").val(),
                    subjectId: $("#SubjectId").val(),
                };
            }
        </script>
    </div>
</div>
<div class="form-group">
    <label class="col-sm-2 control-label">Paper :</label>
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.PaperId)
            .Name(ModelConstants.PaperId)
            .HtmlAttributes(new {style = "width:100%"})
            .Placeholder("Select Paper...")
            .DataTextField(ModelConstants.NameWithId)
            .DataValueField(ModelConstants.Id)
            .Filter(FilterType.Contains)
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("GetPapers", "University")
                        .Data("filterPapers");
                })
                    .ServerFiltering(true);
            })
            .Enable(false)
            .AutoBind(false)
            .CascadeFrom("CategoryId")
            )
        <script>
            function filterPapers() {
                return {
                    coursePartId: $("#CoursePartId").val(),
                    subjectId: $("#SubjectId").val(),
                    categoryId: $("#CategoryId").val(),
                };
            }
        </script>
    </div>
</div>

<script>
    // Function to disable controls
    function disableControls() {
        //alert('Page loading completed');
        //document.getElementById('CollegeId').disabled = true;
        //document.getElementById('SubjectId').disabled = true;
    }

    // Event listener for DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function () {
        // Page has loaded completely, call the disableControls function
        disableControls();
    });

</script>