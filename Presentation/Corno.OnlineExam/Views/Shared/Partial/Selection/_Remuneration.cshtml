@model Corno.Data.Corno.Paper_Setting.Models.Remuneration
@using Corno.Globals.Constants
@using Kendo.Mvc.UI

<div class="form-group">
    @Html.LabelFor(m => m.FacultyId, "Faculty",
        new { @class = "col-sm-2 control-label" })
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.FacultyId)
            .DataTextField(ModelConstants.NameWithId)
            .DataValueField(ModelConstants.Id)
            .HtmlAttributes(new {required = "required", @class="w-100"})
            .Filter("contains")
            .Placeholder("Select ...")
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
            .DataSource(dataSource => dataSource
                .Read(read => read.Action("GetFaculties", "Corno"))
            ))
    </div>
</div>

<div class="form-group">
    @Html.LabelFor(m => m.CollegeId, "College",
        new { @class = "col-sm-2 control-label" })
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CollegeId)
                .DataTextField(ModelConstants.NameWithId)
                .DataValueField(ModelConstants.Id)
                .HtmlAttributes(new {required = "required", @class="w-100"})
                .Filter("contains")
                .Placeholder("Select ...")
                .Columns(columns =>
                {
                    columns.Add().Field(ModelConstants.Id).Width("100px");
                    columns.Add().Field(ModelConstants.Code).Width("100px");
                    columns.Add().Field(ModelConstants.Name).Width("600px");
                })
                .DataSource(dataSource =>
                {
                    dataSource.Read(read =>
                    {
                        read.Action("GetCollegesByFaculty", "Corno").Data("filterCollege");
                    })
                        .ServerFiltering(true);
                })
                .Enable(false)
                .AutoBind(false)
                .CascadeFrom(ModelConstants.FacultyId)
            )
                
        <script>
            function filterCollege() {
                return {
                    facultyId: $("#FacultyId").val()
                };
            }
        </script>
    </div>
</div>

<div class="form-group">
    @Html.LabelFor(m => m.CourseId, "Course :",
        new { @class = "col-sm-2 control-label" })
    <div class="col-sm-10">
        @(Html.Kendo().MultiColumnComboBoxFor(m => m.CourseId)
            //.Enable(Model.EnableHeader)
            .DataTextField(ModelConstants.NameWithId)
            .DataValueField(ModelConstants.Id)
            .HtmlAttributes(new {required = "required", @class = "w-100" })
            .Filter("contains")
            .Placeholder("Select ...")
            .Columns(columns =>
            {
                columns.Add().Field(ModelConstants.Id).Width("100px");
                columns.Add().Field(ModelConstants.Code).Width("100px");
                columns.Add().Field(ModelConstants.Name).Width("600px");
            })
            .DataSource(dataSource =>
            {
                dataSource.Read(read => {read.Action("GetCoursesByFacultyAndCollege", "Corno").Data("filterCourses");})
                    .ServerFiltering(true);
            })
            .Enable(false)
            .AutoBind(false)
            .CascadeFrom(ModelConstants.CollegeId))
        <script>
            function filterCourses() {
                return {
                    FacultyId: $("#FacultyId").val(),
                    CollegeId: $("#CollegeId").val()
                };
            }
        </script>
    </div>
</div>

<script type="text/javascript">
    function GetCleanedFilter(originalFilter) {
        var cleanedFilter = originalFilter.replace(/^\(\d+\)\s*/, '');
        return cleanedFilter;
    }
</script>