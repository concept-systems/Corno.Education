@model Corno.Data.Corno.MarkSheet

@{
    ViewBag.Title = "";
}

<div class="row">
    <div id="breadcrumb" class="col-md-12">
        <ol class="breadcrumb"></ol>
    </div>
</div>

<div class="row">
    <div class="col-xs-12 col-sm-12">
        <div class="box ui-draggable ui-droppable">
            <div class="box-header">
                <div class="box-name">
                    <i class="fa fa-plus-square large"></i>
                    <span>Result Form.</span>
                </div>
                <div class="box-icons">
                    <a class="collapse-link">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                    <a class="expand-link">
                        <i class="fa fa-expand"></i>
                    </a>
                    <a class="close-link">
                        <i class="fa fa-times"></i>
                    </a>
                </div>
                <div class="no-move"></div>
            </div>
            <div class="box-content">
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(false)

                    <div class="form-horizontal" id="horizontalForm">
                        <div class="box-content">
                            <div class="form-group">
                                <div class="panel panel-info">
                                    <div class="panel-heading  "><strong>Bharati Vidyapeeth Deemed University, Pune  -  Result Viewing</strong></div>
                                    <div class="panel-body">
                                        <div class="form-group  has-feedback">
                                            <label class="col-sm-2 control-label">PRN :</label>
                                            <div class="col-sm-3">
                                                @Html.TextBoxFor(m => m.PrnNo, new { @class = "form-control", value = "@Model.PRNNo", placeholder = "PRN No", data_toggle = "tooltip", data_placement = "bottom", title = "PRN No" })
                                            </div>
                                            <div class="col-sm-2">
                                                <button type="submit" value="Create" title="Save" class="btn btn-primary btn-label-left pull-right">
                                                    <span><i class="fa fa-file-pdf-o"></i></span>
                                                    View Result
                                                </button>
                                            </div>
                                            <div class="offset-5 col-sm-2">
                                                <button type="button" value="Index" class="btn btn-primary btn-label-left" onclick="uploadSettlement();" data_toggle="tooltip" data_placement="bottom" title="PRN">
                                                    <span><i class="fa fa-file-excel-o"></i></span>
                                                    EaseBuzz API Download
                                                </button>
                                            </div>
                                        </div>
                                        <div class="form-group  has-feedback">
                                            @if (!string.IsNullOrEmpty(Model.FileName))
                                            {
                                                <div class="col-sm-12">
                                                    <object type="application/pdf" width="100%" height="1300px"
                                                            data="~/Content/MarkSheets/@Model.FileName?#scrollbar=0">
                                                        <p style="font-size: 5vw; padding: 10px" class="text-center text-justify">Your web browser doesn't have a PDF plugin.
                                                            Instead you can
                                                            <a href="~/Content/MarkSheets/@Model.FileName?#scrollbar=0">click here to
                                                                download the PDF file.</a></p>
                                                    </object>
                                                    
                                                    @*@Html.Raw(TempData["Embed"])*@
                                                </div>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    function uploadSettlement() {
        bootbox.prompt('Enter Date (dd-MM-yyyy)!', function (result) {
            var url = '@Url.Action("UploadSettlement", "Result")'; // url
                //var formData = new FormData($('form')[0]); // Create an arbitrary FormData instance
                $.ajax({
                    type: "POST",
                    enctype: 'multipart/form-data',
                    url: url,
                    data: {settlementDate : result}, //formData,
                    success: function (result) {
                        console.log("Status :" + result.message);
                        bootbox.alert(result.message);
                    },
                    error: function(e) {
                        bootbox.alert(e.responseText);
                    }
                });
        });
    }
</script>