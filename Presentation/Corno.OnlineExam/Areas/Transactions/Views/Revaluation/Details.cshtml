@model Corno.Data.Transactions.RevalutionViewModel
@{
    ViewBag.Title = string.Format("Show  Form No : {0}", Model.Id);
}
<div class="row">
    <div id="breadcrumb" class="col-md-12">
        <ol class="breadcrumb">
            <li><a href="#">Online Exam</a></li>
            <li><a href="#">Edit Revalution Form</a></li>
        </ol>
    </div>
</div>
@Html.ValidationSummary()
<div class="row">
    <div class="col-xs-12 col-sm-12">
        <div class="box ui-draggable ui-droppable">
            <div class="box-header">
                <div class="box-name">
                    <i class="fa fa-edit large"></i>
                    <span>Show Revalution Form No :  @Model.Id</span>
                </div>
                <div class="box-icons">
                    <a class="collapse-link">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                    <a class="expand-link">
                        <i class="fa fa-expand"></i>
                    </a>
                    <a class="close-link">
                        <i class="fa fa-times"></i>
                    </a>
                </div>
                <div class="no-move"></div>
            </div>
            <div class="box-content">
                @using (Html.BeginForm())
                {
                    @Html.AntiForgeryToken()
                    @Html.ValidationSummary(true)
                    @Html.HiddenFor(m => m.Id)
                    <div class="form-horizontal">
                        <div class="box-content">
                            <div class="form-group">
                                <div class="col-sm-2">
                                    <button type="button" value="Index" class="btn btn-primary btn-label-left pull-left" onclick="location.href = '@Url.Action("Index", "Revalution")'">
                                        <span><i class="fa fa-list-ul"></i></span>
                                        Back to List
                                    </button>
                                </div>

                            </div>
                            <div class="panel panel-info">
                                <div class="panel-heading">
                                    <strong>Revaluation Details</strong>
                                </div>
                                <div class="form-group  has-feedback">
                                    <label class="col-sm-2 control-label">Seat No :</label>
                                    <div class="col-sm-2">
                                        @Html.DisplayFor(m => m.SeatNo)
                                        @*@Html.TextBoxFor(m => m.SeatNo, new { @id = "SeatNo", @class = "form-control", value = "@Model.SeatNo", placeholder = "Enter Seat No", data_toggle = "tooltip", data_placement = "bottom", title = "Seat No" })*@
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-info">
                                <div class="panel-heading"><strong>Exam Details</strong></div>
                                <table class="table">
                                    <tr>
                                        <th class="text-left col-sm-2"><strong>Name :</strong></th>
                                        <td id="tdName" class="text-left col-sm-6">
                                            @Html.DisplayFor(m => m.StudentName)
                                        </td>
                                        <th class="text-left col-sm-2"><strong>Photo :</strong></th>
                                        <td id="" class="text-left col-sm-2" rowspan="7"><img src="@Model.Photo" width=150px height=200px /></td>
                                    </tr>
                                    <tr>
                                        <th class="text-left col-sm-2"><strong>Centre :</strong></th>
                                        <td id="tdCentre" class="text-left">@Html.DisplayFor(m => m.CentreName)</td>
                                    </tr>
                                    <tr>
                                        <th class="text-left col-sm-2"><strong>College :</strong></th>
                                        <td id="tdCollege" class="text-left">@Html.DisplayFor(m => m.CollegeName)</td>
                                    </tr>
                                    <tr>
                                        <th class="text-left col-sm-2"><strong>Course Type :</strong></th>
                                        <td id="tdCourseType" class="text-left">@Html.DisplayFor(m => m.CoursePartName)</td>
                                    </tr>
                                    <tr>
                                        <th class="text-left col-sm-2"><strong>Course :</strong></th>
                                        <td id="tdCourse" class="text-left">@Html.DisplayFor(m => m.CourseName)</td>
                                    </tr>
                                    <tr>
                                        <th class="text-left col-sm-2"><strong>Branch :</strong></th>
                                        <td id="tdBranch" class="text-left">@Html.DisplayFor(m => m.BranchName)</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="panel panel-info">
                                <div class="panel-heading">
                                    Subjects
                                </div>
                                <div class="panel-body ">
                                    <table class=" table table-bordered table-striped table-responsive table-hover table-heading table-datatable" id="datatable-1">
                                        <thead>
                                            <tr>
                                                <th class="text-center col-sm-1">Course Part Code</th>
                                                <th class="text-center col-sm-3">Course Part </th>
                                                <th class="text-center col-sm-1">Subject Code</th>
                                                <th class="text-center col-sm-5">Subject</th>
                                                <th class="text-center col-sm-1">Revaluation</th>
                                                <th class="text-center col-sm-1">Verification</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @{ var index = 0; }
                                            @foreach (var item in @Model.RevalutionSubjectViewModels)
                                            {
                                                <tr>
                                                    <td class="text-center">
                                                        @Html.Hidden("revalutionSubjectViewModels[" + index + "].CoursePartID", @item.CoursePartId)
                                                        @Html.DisplayFor(i => @item.CoursePartId)
                                                    </td>
                                                    <td>
                                                        @Html.Hidden("revalutionSubjectViewModels[" + index + "].CoursePartName", @item.CoursePartName)
                                                        @Html.DisplayFor(m => m.RevalutionSubjectViewModels.ToList()[index].CoursePartName)
                                                    </td>
                                                    <td class="text-center">
                                                        @Html.Hidden("revalutionSubjectViewModels[" + index + "].SubjectCode", @item.SubjectCode)
                                                        @Html.DisplayFor(m => m.RevalutionSubjectViewModels.ToList()[index].SubjectCode)
                                                    </td>
                                                    <td>
                                                        @Html.Hidden("revalutionSubjectViewModels[" + index + "].SubjectName", @item.SubjectName)
                                                        @Html.DisplayFor(m => m.RevalutionSubjectViewModels.ToList()[index].SubjectName)
                                                    </td>
                                                    <td class align="center">
                                                        @*@Html.Hidden("revalutionSubjectViewModels[" + index + "].IsRevaluation", @item.IsRevaluation)*@
                                                        @Html.CheckBox("revalutionSubjectViewModels[" + index + "].IsRevaluation", @item.IsRevaluation, new { @class = "checkbox" })
                                                        @*@Html.CheckBoxFor(m => m.IsRevaluation, new { @class = "checkbox" })*@
                                                    </td>
                                                    <td class align="center">
                                                        @*@Html.Hidden("revalutionSubjectViewModels[" + index + "].IsVerification", @item.IsVerification)*@
                                                        @Html.CheckBox("revalutionSubjectViewModels[" + index + "].IsVerification", @item.IsVerification, new { @class = "checkbox" })
                                                    </td>
                                                </tr>
                                                index++;
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            @*<div class="panel panel-info">
                                        <div class="panel-heading"><strong>Revaluation Details</strong></div>

                                        <div class="panel panel-info">
                                            @(Html.Kendo().Grid(Model.RevalutionSubjectViewModels.OrderBy(e => e.SubjectCode))
                                    .Name("RevalutionSubjectViewModels")
                                                .HtmlAttributes(new { style = "height:100%;" })
                                                .Columns(columns =>
                                                {
                                                    //columns.Bound(c => c.RowSelector).Title("Select");
                                                    columns.Bound(p => p.CoursePartID).Title("Course Part Code").Width(130);
                                                    columns.Bound(p => p.CoursePartName).Title("Course Part").Width(150);
                                                    columns.Bound(p => p.SubjectCode).Title("Subject Code").Width(120); ;
                                                    columns.Bound(p => p.SubjectName).Title("Subject");
                                                    columns.Bound(p => p.IsRevaluation).Title("Revaluation");
                                                    columns.Bound(p => p.IsVerification).Title("Verification");

                                                    columns.Bound(p => p.InstanceID).Title("Instance").Hidden();
                                                    columns.Bound(p => p.InstanceID).Title("ID").Hidden();
                                                })
                                //.Sortable()
                                                .Groupable()
                                //.Scrollable()
                                //.Selectable()
                                                .DataSource(dataSource => dataSource
                                                    .Ajax()
                                                    //.Events(events => events.Error("onError"))
                                                    .Group(group => group.Add(p => p.SubjectCode))
                                                    .Model(model =>
                                                    {
                                                        // Following line is important. Don't Delete. Model's id field needs to be assigned to value field.
                                                        // Otherwise, Row will be deleted after cancel action of edit command.
                                                        model.Id(p => p.SubjectCode);
                                                        model.Field(p => p.SubjectName).Editable(false);
                                                        model.Field(p => p.CoursePartID).Editable(false);
                                                        model.Field(p => p.SubjectCode).Editable(false);
                                                        model.Field(p => p.CoursePartName).Editable(false);
                                                        model.Field(p => p.IsRevaluation).Editable(false);
                                                        model.Field(p => p.IsVerification).Editable(false);

                                                        model.Field(p => p.InstanceID).Editable(false);
                                                    })
                                                    .Batch(true)
                                                    .ServerOperation(false)
                                                    .Read(read => read.Action("GetData", "Revalution").Data("filterSubjects"))
                                                )
                                                .Events(events => events.DataBound("dataBound"))
                                            )
                                            <script>
                                                function filterSubjects() {
                                                    return {
                                                        prnNo: $("#SeatNo").val(),
                                                        coursePartID: selectedCoursePartID,
                                                    };
                                                }

                                                //function index(dataItem) {
                                                //    var data = $("#ExamSubjectViewModels").data("kendoGrid").dataSource.data();
                                                //    return data.indexOf(dataItem);
                                                //}

                                                //function onError(e, status) {
                                                //    if (e.status == "customerror") {
                                                //        //ClearForm();
                                                //        alert(e.errors);
                                                //    }
                                                //    else {
                                                //        alert("Generic server error.");
                                                //    }
                                                //}
                                            </script>
                                        </div>
                                    </div>*@

                            <div class="form-group">
                                <div class="col-sm-2">
                                    <button type="button" value="Index" class="btn btn-primary btn-label-left pull-left" onclick="location.href = '@Url.Action("Index", "Revalution")'">
                                        <span><i class="fa fa-list-ul"></i></span>
                                        Back to List
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@*<script type="text/javascript">

        function filterCourses() {
            return {
                CollegeID: $("#CollegeID").val(),
                CourseTypeID: $("#CourseTypeID").val()
                //courseFilter: $("#CourseID").data("kendoComboBox").input.val()
            };
        }
        $('#SeatNo').change(function () {
            //    $("#horizontalForm").printThis();
            //    alert("pirnt");
            //    return;

            $.ajax({
                url: '@Url.Action("SeatNoChange", "Revalution")',
                type: 'post',
                data: {
                    SeatNo: $('#SeatNo').val()
                },
                success: function (_result) {
                    if (null == _result.Centre || undefined == _result.Centre) {
                        alert(_result);
                    }
                    //success: function (_result)
                    {
                        $('#tdCentre').html(_result.Centre);
                        $('#tdCollege').html(_result.College);
                        $('#tdCourseType').html(_result.CourseType);
                        $('#tdCourse').html(_result.Course);
                        $('#tdCoursePart').html(_result.CoursePart);
                        $('#tdName').html(_result.StudentName);
                        //$('#tdEmail').html(_result.Email);
                        $('#tdName').val(_result.StudentName)
                        $('#tdPhoto').html('<img src="' + _result.Photo + '" />');
                        //alert(_result.StudentID);
                    }
                }
            });
        });
    </script>*@